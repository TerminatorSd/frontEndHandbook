> 知识点速记

### 要点整理
- 雅虎特别性能小组提出的优化JS 的首要规则：将脚本放在底部
- defer 属性指明元素所含的脚本不会修改DOM，异步加载，在DomContentLoaded 之后、load之前执行
- 动态加载JS 的方法：loadScript 脚本和xhr 注入
- Question: Web 本身的设计是，一旦遇到js，立马执行。因为它可能会操作dom影响最终的渲染结果。这里的懒加载方案似乎都在朝着原本的设计逆向而行，即等页面渲染完了，再去加载js。既然如此，js一开始为什么要设置成这样的？
- 作用域导致的变量和函数的查找会影响性能，所以可以通过局部变量存储的方式较少高操作成本变量的操作次数；with 语句改变了作用域链，因此访问的代价更高
- 执行location.href 比window.location.href 更快
- DOM 和JS 像两座岛屿，每次过桥都需要缴纳“过路费”，因此操作DOM 天生就慢
- getComputedStyle、offsetTop 等会引起页面重排，操作成本高
- for in 性能较差，所以如果知道对象中的属性，就不要用for in；switch 比if-else 运行的要快，但只有当条件数量很大的情况下才快的明显
- forEach 的性能比for 循环要差，所以建议使用for 循环遍历数组；倒序遍历相对于正序遍历可以再次加速（减少迭代运算量）
- 减少迭代循环次数：达夫设备！
- 正则表达式中的回溯失控可能会导致电脑崩溃，比如说用/(A+A+)+B/来匹配AAAAAAAAAA；可以用反向引用来解决回溯失控问题
- 单个JS 运行的时间不应该超过100ms；可以通过setTimeout 实现yield 操作
- 用png 上报数据的方法称为图片信标，能装载的数据量非常小，所以arms 要实时上报
- 图片或pdf 文件在传输过程中不应该使用gzip 压缩，因为他们本身已经被压缩过，试图重复压缩只会浪费服务器资源你


### Others
- 《可怕的终止操作错误》
- 《正则表达式手册》